{% extends 'include/homepage.html' %}
{% load static %}
{% block content %}
{% include 'include/header.html' %}
<style>
  option {
    padding-right: 15px;
  }


  #step_8 input[type="text"] {
    background-color: #fff;
    border: 0;
    border-radius: 2px;
    box-shadow: 0 1px 4px -1px rgba(0, 0, 0, 0.3);
    margin: 10px;
    padding: 0 0.5em;
    font: 400 18px Roboto, Arial, sans-serif;
    overflow: hidden;
    line-height: 40px;
    margin-right: 0;
    min-width: 25%;
  }

  #step_8 input[type="button"] {
    background-color: #fff;
    border: 0;
    border-radius: 2px;
    box-shadow: 0 1px 4px -1px rgba(0, 0, 0, 0.3);
    margin: 10px;
    padding: 0 0.5em;
    font: 400 18px Roboto, Arial, sans-serif;
    overflow: hidden;
    height: 40px;
    cursor: pointer;
    margin-left: 5px;
  }

  #step_8 input[type="button"]:hover {
    background: rgb(235, 235, 235);
  }

  #step_8 input[type="button"].button-primary {
    background-color: #1a73e8;
    color: white;
  }

  #step_8 input[type="button"].button-primary:hover {
    background-color: #1765cc;
  }

  #step_8 input[type="button"].button-secondary {
    background-color: white;
    color: #1a73e8;
  }

  #step_8 input[type="button"].button-secondary:hover {
    background-color: #d2e3fc;
  }
</style>

<script>
  /**
   * @license
   * Copyright 2019 Google LLC. All Rights Reserved.
   * SPDX-License-Identifier: Apache-2.0
   */
  let map;
  let marker;
  let geocoder;
  let responseDiv;
  let response;

  function initMapCreateProd() {
    map = new google.maps.Map(document.getElementById("map_create_product"), {
      zoom: 8,
      center: { lat: -34.397, lng: 150.644 },
      mapTypeControl: false,
    });
    geocoder = new google.maps.Geocoder();

    const inputText = document.createElement("input");

    inputText.type = "text";
    inputText.placeholder = "Enter a location";
    const submitButton = document.createElement("input");

    submitButton.type = "button";
    submitButton.value = "Geocode";
    submitButton.classList.add("button", "button-primary");

    const clearButton = document.createElement("input");

    clearButton.type = "button";
    clearButton.value = "Clear";
    clearButton.classList.add("button", "button-secondary");
    response = document.createElement("pre");
    response.id = "response";
    response.innerText = "";
    responseDiv = document.createElement("div");
    responseDiv.id = "response-container";
    responseDiv.appendChild(response);

    const instructionsElement = document.createElement("p");

    instructionsElement.id = "instructions";
    instructionsElement.innerHTML =
      "<strong>Instructions</strong>: Enter an address in the textbox to geocode or click on the map to reverse geocode.";
    map.controls[google.maps.ControlPosition.TOP_LEFT].push(inputText);
    map.controls[google.maps.ControlPosition.TOP_LEFT].push(submitButton);
    map.controls[google.maps.ControlPosition.TOP_LEFT].push(clearButton);
    map.controls[google.maps.ControlPosition.LEFT_TOP].push(
      instructionsElement
    );
    map.controls[google.maps.ControlPosition.LEFT_TOP].push(responseDiv);
    marker = new google.maps.Marker({
      map,
    });
    map.addListener("click", (e) => {
      geocode({ location: e.latLng });
    });
    submitButton.addEventListener("click", () =>
      geocode({ address: inputText.value })
    );
    clearButton.addEventListener("click", () => {
      clear();
    });
    clear();
  }

  function clear() {
    marker.setMap(null);
  }

  function geocode(request) {
    clear();
    geocoder
      .geocode(request)
      .then((result) => {
        const { results } = result;

        map.setCenter(results[0].geometry.location);
        marker.setPosition(results[0].geometry.location);
        marker.setMap(map);
        response.innerText = JSON.stringify(result, null, 2);
        return results;
      })
      .catch((e) => {
        alert("Geocode was not successful for the following reason: " + e);
      });
  }

  window.initMapCreateProd = initMapCreateProd;
</script>
<div class="container-fluid bg-estimation bg-100">
  <form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="container-fluid"
      style="background: url({% static 'assets/images/bg.png' %}) center center;   background-size: cover;">
      <div class="container profil-content">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
          <div class="dh-hover-box">
            <h1 id="h1" class="text-center"></h1>
            <br><br>
          </div>
        </div>
      </div>
    </div>
    <div class="container step" id="step_1">
      <div class="col-xs-12 col-sm-7 col-md-7 col-lg-7 profil-content">
        <div class="bg-50">
          <div
            class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-12 has-feedback-right-connexion bot-20 meal-label">
            <div class="form-group">
              <label class="control-label required" for="form_meal_type">{{ index_host.question_1 }}</label><select
                required id="form_meal_type"
                style="border: 1px solid #000; border-radius: 15px !important; padding-right:30px !important ; -moz-appearance:none; appearance:none; background-image: url('{% static 'assets/images/arrow.png' %}'); background-repeat: no-repeat; background-position: 95% 50%; cursor: pointer !important;"
                name="category" class="form-control">
                {% for category in categories %}
                <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
              </select>
            </div>
          </div>
          <div
            class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-12 has-feedback-right-connexion bot-40 meal-label">
            <div class="form-group">
              <label class="control-label required" for="form_meal_cook_type">{{ index_host.question_2 }}</label>
              <select required id="form_meal_cook_type"
                style="border: 1px solid #000; border-radius: 15px !important; padding-right:30px !important ; -moz-appearance:none; appearance:none; background-image: url('{% static 'assets/images/arrow.png' %}'); background-repeat: no-repeat; background-position: 95% 50%; cursor: pointer !important;"
                name="kind" class="form-control">
                {% for kind in kinds %}
                <option value="{{ kind.id }}">{{ kind.name }}</option>
                {% endfor %}
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container step" id="step_2">
      <div class="col-xs-12 col-sm-7 col-md-7 col-lg-7 profil-content">
        <div class="bg-50">
          <h3 class="top-40 bot-20">{{ index_host.question_5 }}</h3>
          <div class="form-group has-feedback-right-connexion bottom-space is-empty">
            <input required type="text" id="search"
              style="border: 1px solid #000; border-radius: 15px !important; padding-right:15px !important ;"
              name="title" class="form-control pac-target-input" placeholder="Название продукта" autocomplete="off" />
          </div>
          <h3 class="top-40 bot-20">{{ index_host.question_6 }}</h3>

          <div class="form-group has-feedback-right-connexion">
            <textarea id="form_description"
              style="border: 1px solid #000; border-radius: 15px !important; padding-right:15px !important ;"
              name="description" class="descrip-text form-control" style="resize: none;" placeholder="Описание продукта"
              required></textarea>
          </div>
        </div>
      </div>
    </div>
    <div class="container step" id="step_3">
      <div class="col-xs-12 col-sm-7 col-md-7 col-lg-7 profil-content">
        <div class="bg-50">
          <h3 class="top-40 bot-20">{{ index_host.question_3 }}</h3>
          <div class="form-group has-feedback-right-connexion">
            <input required type="number" placeholder="Цена (в долларах)" id="form_numberMax"
              style="border: 1px solid #000; border-radius: 15px !important; padding-right:15px !important ;"
              name="price" class="form-control" />
          </div>
          <h3 class="top-40 bot-20">{{ index_host.question_4 }}</h3>
          <div class="form-group has-feedback-right-connexion">
            <input required type="number" placeholder="Цена доаставки (в долларах)" id="form_numberMin"
              style="border: 1px solid #000; border-radius: 15px !important; padding-right:15px !important ;"
              name="delivery_price" class="form-control" />
          </div>
        </div>
      </div>
    </div>
    <div class="container step d-none bg-estimation" id="step_4">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 bg-80">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 top-40 bot-20 profil-content">
          <h3>{{ index_host.question_7 }}</h3>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
          <div class="profil-content col-xs-12 col-sm-12 col-md-6 col-lg-6">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 profil-content">
              <input required type="file"
                style="border: 1px solid #000; border-radius: 15px !important; padding-right:15px !important ;"
                name="image" id="form_name" class="bot-20 profil-content inputfilephotoinscription"
                onchange="readURL(this)" style="display:none" />

              <img class="photoinscription fsm-thumbnail img-responsive" style="z-index:1" />
              <button class="btn btn-default btn-pink-photo w-75" id="buttonFileSelect" type="button"
                onclick="selectPhoto(event)"><span class="glyphicon glyphicon-picture"></span></button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container step d-none bg-estimation" id="step_5">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 bg-80">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 top-40 bot-20 profil-content">
          <h3>{{ index_host.question_8 }}</h3>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
          <div class="profil-content col-xs-12 col-sm-12 col-md-6 col-lg-6">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 profil-content">
              <input required type="file"
                style="border: 1px solid #000; border-radius: 15px !important; padding-right:15px !important ;"
                name="images" id="form_name" multiple class="bot-20 profil-content" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container step d-none bg-estimation" id="step_6">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 bg-80">
        <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-12 has-feedback-right-connexion bot-40 meal-label">
          <div class="form-group">
            <label class="control-label required" for="form_meal_cook_type">Какой тип доставки у этого продукта</label>
            <select required id="form_meal_cook_type"
              style="border: 1px solid #000; border-radius: 15px !important; padding-right:15px !important ;"
              name="delivery_type" class="form-control">
              <option value="in_city">in city</option>
              <option value="in_state">in state</option>
              <option value="no_delivery">No delivery</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    <div class="container step d-none bg-estimation" id="step_7">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 bg-80">
        <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-12 has-feedback-right-connexion bot-40 meal-label">
          <div class="form-group">
            <label class="control-label required" for="form_meal_cook_type">Дата доступности продукта</label>
            <div class="form-group has-feedback-right-connexion bottom-space is-empty">
              <input required type="text"
                style="border: 1px solid #000; border-radius: 15px !important; padding-right:15px !important ;"
                class="form-control pac-target-input" placeholder="Дата доступности продукта" autocomplete="off" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container step d-none bg-estimation" id="step_8">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 bg-80">
        <div class="form-group">
          <label class="control-label required" for="form_meal_cook_type"
            style="text-align: center;margin: 10px 0;width: 100%;font-size: 30px;">Укажите свой адрес</label>

        </div>
        <div id="map_create_product" style="width: 100%;height:400px;margin: 20px 0;"></div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 profil-content" style="position: fixed; bottom: 0;">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 option-space top-border">
        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
          <span id="return" class="btn btn-empty btn-lg pull-left" onclick="showPrevious()" type="button"><i class="fa fa-arrow-left" aria-hidden="true"></i> {{ index_host.button_3 }}</span>
          <a id="back" class="btn btn-empty btn-lg pull-left" onclick="back2()" type="button"><i class="fa fa-arrow-left" aria-hidden="true"></i> {{ index_host.button_3 }}</a>
        </div>
        
        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
          <button id="next" class="btn btn-danger btn-lg pull-right" onclick="showNext()" type="button">&nbsp; {{
            index_host.button_2 }}</button>
          <button id="submit_q" class="btn btn-danger btn-lg pull-right d-none" type="submit"><i
              class="fa fa-check fa-lg" aria-hidden="true"></i>&nbsp; Подтвердить</button>
        </div>
      </div>
    </div>
  </form>
</div>


<script>
  function selectPhoto(e) {
    e.preventDefault()
    $('.inputfilephotoinscription').click()
  }
  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader()
      reader.onload = function (e) {
        $('.photoinscription').attr('src', e.target.result)
        sessionStorage.setItem('photoinscriptionsrc', e.target.result)
      }
      reader.readAsDataURL(input.files[0])
    }
  }
</script>
<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAcWfRjT5_IdyA5SJfvFS5o_bHbrIxWUhk&callback=initMapCreateProd&v=weekly&solution_channel=GMP_CCS_geocodingservice_v1"
  defer></script>
{% include 'include/footer.html' %}
{% endblock %}